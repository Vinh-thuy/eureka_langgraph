Architecture cible : Lisab â†” TWIN (plateforme agentique LangGraph)

Pour clarifier le modÃ¨le et rassurer tout le monde sur la rÃ©partition des rÃ´les et des stacks techniques :

â¸»

ğŸ”¹ RÃ´le de Lisab (Django)
	â€¢	Connecteur natif Teams â†’ @TWIN
	â€¢	Gestion identitÃ© / droits / contexte utilisateur (via Azure AD / Teams)
	â€¢	Construction et transmission vers TWIN de :
	â€¢	un user_id (utilisateur mÃ©tier)
	â€¢	un thread_id (fil de conversation Teams)
	â€¢	Logs dâ€™audit applicatif vers les outils groupe (Elastic / SIEM)

ğŸ‘‰ Lisab ne gÃ¨re pas la mÃ©moire conversationnelle, il fournit les identifiants qui permettront Ã  la plateforme TWIN de le faire proprement.

â¸»

ğŸ”¹ RÃ´le de la plateforme TWIN (LangGraph / LangChain)
	â€¢	Cerveau agentique : DeepAgent + sous-agents (Infra, Metrics, ITSM, etc.)
	â€¢	Persistance des sessions :
	â€¢	Session de conversation (par thread_id) : Ã©tat du graphe, contexte du fil @TWIN
	â€¢	Session utilisateur (par user_id) : mÃ©moire long terme propre Ã  chaque utilisateur
	â€¢	Gestion :
	â€¢	du raisonnement, du routing, des workflows techniques
	â€¢	de lâ€™historique des Ã©changes et du contexte LLM

ğŸ‘‰ Toute la mÃ©moire (intra-session et inter-session) vit cÃ´tÃ© TWIN / LangGraph.

â¸»

ğŸ”¹ Gestion des sessions : qui fait quoi ?
	â€¢	Session de conversation (@TWIN dans un thread Teams)
	â€¢	Identifiant : thread_id construit par Lisab
	â€¢	Persistance : gÃ©rÃ©e par LangGraph (checkpoints + historique)
	â€¢	Session utilisateur (mÃ©moire cross-conversation)
	â€¢	Identifiant : user_id fourni par Lisab
	â€¢	Persistance : gÃ©rÃ©e par LangChain / LangGraph via des mÃ©canismes de Memory / MessageHistory

â¸»

ğŸ”¹ Stacks techniques & briques utilisables cÃ´tÃ© TWIN
	â€¢	LangGraph
	â€¢	Gestion de lâ€™Ã©tat du graphe (GraphState)
	â€¢	Checkpoints persistÃ©s dans Postgres (ou Redis / autre backend)
	â€¢	Support natif des thread_id pour les sessions
	â€¢	LangChain
	â€¢	Memory : ConversationSummaryMemory, ConversationBufferMemory, etc.
	â€¢	MessageHistory stores : Postgres / Redis pour historiser les messages par user_id / thread_id
	â€¢	Infra persistance
	â€¢	Postgres : stockage des checkpoints et de lâ€™historique
	â€¢	Redis (optionnel) : cache / historique court terme
	â€¢	LangSmith : observabilitÃ©, tracing des runs agents / LLM









Architecture cible : Lisab â†” TWIN (plateforme agentique LangGraph)

Nous confirmons lâ€™architecture cible suivante pour lâ€™intÃ©gration entre Lisab et la plateforme TWIN, avec PostgreSQL comme unique backend de persistance.

â¸»

ğŸ”¹ RÃ´le de Lisab (Django)
	â€¢	Connecteur natif Teams â†’ @TWIN
	â€¢	Gestion de lâ€™identitÃ© et des droits (Azure AD / Teams)
	â€¢	Construction et transmission vers TWIN de :
	â€¢	un user_id (identifiant utilisateur applicatif)
	â€¢	un thread_id (identifiant de la session de conversation Teams)
	â€¢	Envoi des logs dâ€™audit vers les outils groupe (Elastic / SIEM / Data Lake)

ğŸ‘‰ Lisab ne gÃ¨re pas la mÃ©moire conversationnelle : il fournit les identifiants (user + thread) qui permettent Ã  TWIN de le faire cÃ´tÃ© LangGraph.

â¸»

ğŸ”¹ RÃ´le de la plateforme TWIN (LangGraph / LangChain)
	â€¢	Cerveau agentique : DeepAgent + sous-agents (Infra, Metrics, ITSM, etc.)
	â€¢	Persistance des sessions dans PostgreSQL :
	â€¢	Session de conversation (par thread_id) : Ã©tat du graphe, historique du fil @TWIN, contexte LLM
	â€¢	Session utilisateur (par user_id) : mÃ©moire longue durÃ©e propre Ã  chaque utilisateur (contexte, prÃ©fÃ©rences, historique fonctionnel)
	â€¢	Gestion du :
	â€¢	raisonnement, du routing multi-agents et des workflows techniques
	â€¢	contexte intra- et inter-session (ce qui sâ€™est passÃ© avant, dans ce thread ou avec ce user)

ğŸ‘‰ Toute la mÃ©moire (conversationnelle et utilisateur) est centralisÃ©e cÃ´tÃ© TWIN, avec une persistance unique dans PostgreSQL.

â¸»

ğŸ”¹ Stacks techniques retenues cÃ´tÃ© TWIN
	â€¢	LangGraph : graph dâ€™agents, gestion de lâ€™Ã©tat (GraphState), checkpoints persistÃ©s dans PostgreSQL, utilisation de thread_id pour suivre les sessions
	â€¢	LangChain : Memory (ConversationSummaryMemory, etc.) et MessageHistory stockÃ©es dans PostgreSQL (messages user / assistant / tools)
	â€¢	PostgreSQL : backend unique pour les checkpoints, lâ€™historique des messages et la mÃ©moire utilisateur
	â€¢	LangSmith (si activÃ©) : observabilitÃ©, tracing des runs (prompts, appels dâ€™outils, dÃ©cisions dâ€™agents)

â¸»

ğŸ¯ Objectif

Simplifier Lisab, centraliser toute la mÃ©moire et la persistance des sessions dans LangGraph / LangChain avec PostgreSQL, et garantir une architecture claire, scalable et conforme pour le dÃ©ploiement de TWIN dans Teams.
